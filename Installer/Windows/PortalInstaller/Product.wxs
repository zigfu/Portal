<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="ed31d10e-5933-44a2-833b-a0278cbbc10c" Name="ZigFu Portal" Language="1033" Version="1.0.0.0" Manufacturer="ZigFu" UpgradeCode="97a671a7-ab73-49fe-a237-37b6a331747d">
		<Package InstallerVersion="200" Compressed="yes" Id="*" Description="ZigFu Portal Installer"/>

		<Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- define base output dir -->
      <Directory Id="LocalAppDataFolder">
        <Directory Id="BaseOutputDir" Name="ZigFu">

        </Directory>
      </Directory>

      <Directory Id="DesktopFolder" Name="Desktop" />
      
      <!-- directories for shortcuts -->
      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuContainerDir" Name="ZigFu">
          <Directory Id="ProgramMenuDir" Name="Portal">
            <Component Id="ProgramMenuDir" Guid="1C3983DB-B982-48CB-845F-8E2F4D1F85F2">
              <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
              <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
              <!-- these shortcuts are a nasty hack, but they work (ideally I could add them to the auto-generated 
                   output from heat.exe at Files.wxs (ideally they should be under the File element containing the Portal exe) -->
              <!-- this is going to change on the next major version of WIX -->
              <Shortcut Id="startmenuPortal" Directory="ProgramMenuDir" Name="Portal" Target="[BaseOutputDir]\Portal\bin\Portal.exe"/>
              <Shortcut Id="desktopPortal" Directory="DesktopFolder" Name="Portal" Target="[BaseOutputDir]\Portal\bin\Portal.exe"/>
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </Directory>
    <UIRef Id="WixUI_Minimal"/>
    <WixVariable Id="WixUILicenseRtf" Value="license.rtf"/>
		<Feature Id="ProductFeature" Title="Portal" Level="1">
			<ComponentGroupRef Id="AllFiles" />
      <ComponentRef Id="ProgramMenuDir" />
			<!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->
			<ComponentGroupRef Id="Product.Generated" />
		</Feature>
	</Product>
</Wix>
